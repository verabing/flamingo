<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Flamingo meets artist ¬∑ Styles</title>

  <link rel="icon" href="favicon.ico" type="image/x-icon">
  <link rel="shortcut icon" href="favicon.ico" type="image/x-icon">

  <script src="https://unpkg.com/papaparse@5.4.1/papaparse.min.js"></script>

  <style>
    :root {
      --accent:#db3553;
      --accent-weak:#fbe3e7;
      --bg:#fff;
      --text:#2b2b2b;
      --muted:#666;
      --border:#eee;
      --radius:14px;
      --shadow:0 6px 24px rgba(0,0,0,.06);
    }
    *{box-sizing:border-box;margin:0;padding:0}
    body {
      background: var(--bg);
      color: var(--text);
      font-family: system-ui,Segoe UI,Roboto,Inter,sans-serif;
      min-height: 100vh;
      overflow-x: hidden;
    }

    header {
      position: sticky;
      top: 0;
      background: var(--accent);
      color: white;
      text-align: center;
      padding: 14px;
      font-weight: 700;
      font-size: 22px;
      z-index: 10;
    }

    /* Top-Buttons im Header */
    .top-btn {
      position: absolute;
      top: 10px;
      left: 10px;
      padding: 8px 14px;
      border-radius: 10px;
      border: 1px solid #fff;
      background: transparent;
      color: #fff;
      font-weight: 600;
      text-decoration: none;
      transition: background .2s, color .2s, transform .2s;
      box-shadow: none;
      z-index: 30;
    }
    .top-btn:hover { background:#fff; color:var(--accent); transform: translateY(-1px); }

    /* Zweiter Button rechts daneben */
    #backBtn { left: 190px; display: none; }

    main {
      position: relative;
      min-height: calc(100vh - 120px);
      padding: 20px;
      text-align: center;
    }

    .style-grid {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 12px;
      margin-top: 20px;
    }

    .style-btn {
      padding: 12px 20px;
      background: var(--accent-weak);
      border: 1px solid var(--accent);
      border-radius: var(--radius);
      color: var(--accent);
      font-weight: 600;
      cursor: pointer;
      transition: background .2s;
    }
    .style-btn:hover { background: var(--accent); color: #fff; }

    .floating-gallery {
      position: relative;
      width: 100%;
      height: calc(100vh - 220px); /* Spielfl√§che unter Header */
      overflow: hidden;
      margin-top: 10px;
    }
    .floating-gallery img {
      position: absolute;
      object-fit: cover;
      border-radius: 12px;
      box-shadow: var(--shadow);
      transition: transform .2s;
    }
    .floating-gallery img:hover { transform: scale(1.05); z-index: 2; }

    .artist-label {
      position: absolute;
      color: #333;
      font-size: 12px;
      font-weight: 600;
      text-shadow: 1px 1px 2px rgba(255,255,255,.8);
      pointer-events: none;
    }

    .center-title {
      font-size: 38px;
      font-weight: 900;
      color: var(--accent);
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      text-shadow: 0 0 10px #fff;
      pointer-events: none;
    }

    footer {
      text-align:center;
      font-size:12px;
      color:#777;
      margin:40px auto 20px;
      max-width:600px;
      line-height:1.6;
    }

    .hidden { display: none !important; }

    @media (max-width: 768px) {
      header { font-size: 18px; padding: 10px; }
      .style-btn { padding: 8px 12px; font-size: 13px; border-radius: 8px; }
      .style-grid { gap: 8px; padding: 0 10px; }
      .center-title { font-size: 26px; }
      /* Buttons enger */
      .top-btn { padding: 6px 10px; font-size: 13px; }
      #backBtn { left: 150px; }
      /* Spielfl√§che kompakter, Bilder kleiner */
      .floating-gallery { height: calc(100vh - 240px); }
      .floating-gallery img { width: 80px !important; height: 80px !important; }
      .artist-label { font-size: 11px; }
      footer { font-size: 11px; padding: 10px; }
    }
  </style>
</head>
<body>

  <header>Flamingo by Style</header>
  <a href="index.html" class="top-btn">ü¶© Back to main gallery</a>
  <button class="top-btn" id="backBtn">‚Üê Back to styles</button>

  <main>
    <div id="styleList" class="style-grid"></div>
    <div id="galleryView" class="floating-gallery"></div>
    <h1 id="styleTitle" class="center-title hidden"></h1>
  </main>

  <footer>
    <p>All flamingo artworks are AI interpretations inspired by the styles of various artists.
    This is a non-commercial art appreciation project.</p>
  </footer>

 <script>
  const SHEET_CSV_URL = "https://docs.google.com/spreadsheets/d/1REI62_PJYuDrFoasl6j6KfQUkVGvLKKlrF5Lzga10t4/gviz/tq?tqx=out:csv";
  const COL = { style: 'Art style', photo: 'Photo', name: 'artist' };

  const els = {
    styleList: document.getElementById('styleList'),
    galleryView: document.getElementById('galleryView'),
    styleTitle: document.getElementById('styleTitle'),
    backBtn: document.getElementById('backBtn')
  };

  let rows = [];

  Papa.parse(SHEET_CSV_URL, {
    download: true,
    header: true,
    skipEmptyLines: true,
    complete: res => {
      rows = res.data.filter(r => r[COL.name]);
      initStyles();
    }
  });

  function uniqSorted(list) {
    return [...new Set(list.filter(Boolean))].sort((a, b) => a.localeCompare(b));
  }

  // üî• Styles korrekt aufsplitten, trimmen und vereinheitlichen
  function initStyles() {
    const styles = uniqSorted(
      rows.flatMap(r =>
        String(r[COL.style] || "")
          .split(",")
          .map(s => s.trim())
          .filter(Boolean)
      )
    );

    els.styleList.innerHTML = "";
    styles.forEach(s => {
      const btn = document.createElement("button");
      btn.className = "style-btn";
      btn.textContent = s;
      btn.onclick = () => showStyle(s);
      els.styleList.appendChild(btn);
    });
  }

  function showStyle(styleName) {
    els.styleList.style.display = "none";
    els.galleryView.innerHTML = "";
    els.styleTitle.textContent = styleName;
    els.styleTitle.classList.remove("hidden");
    els.backBtn.style.display = "block";

    const filtered = rows.filter(r =>
      String(r[COL.style] || "")
        .split(",")
        .map(s => s.trim().toLowerCase())
        .includes(styleName.toLowerCase())
    );

    // Automatische Skalierung
    let imgWidth = 120,
      imgHeight = 120;
    if (filtered.length > 20) imgWidth = imgHeight = 90;
    if (filtered.length > 35) imgWidth = imgHeight = 70;

    const placed = [];
    const padding = 30;
    const area = els.galleryView.getBoundingClientRect();
    const viewW = area.width;
    const viewH = area.height;

    filtered.forEach(r => {
      const img = document.createElement("img");
      img.src = r[COL.photo];
      img.alt = r[COL.name];
      img.style.width = imgWidth + "px";
      img.style.height = imgHeight + "px";

      let x, y, overlap, attempts = 0;
      do {
        overlap = false;
        x = Math.random() * (viewW - imgWidth - padding);
        y = Math.random() * (viewH - imgHeight - padding);

        for (const p of placed) {
          const horizontal = x < p.x + imgWidth + padding && x + imgWidth + padding > p.x;
          const vertical = y < p.y + imgHeight + padding && y + imgHeight + padding > p.y;
          if (horizontal && vertical) { overlap = true; break; }
        }
        attempts++;
      } while (overlap && attempts < 200);

      placed.push({ x, y });

      img.style.left = (x / viewW * 100) + "%";
      img.style.top = (y / viewH * 100) + "%";
      els.galleryView.appendChild(img);

      const label = document.createElement("div");
      label.className = "artist-label";
      label.textContent = r[COL.name];
      label.style.left = `calc(${x / viewW * 100}% + 4px)`;
      label.style.top = `calc(${y / viewH * 100}% + ${imgHeight + 6}px)`;
      els.galleryView.appendChild(label);
    });
  }

  function showList() {
    els.galleryView.innerHTML = "";
    els.styleList.style.display = "flex";
    els.styleTitle.classList.add("hidden");
    els.styleTitle.textContent = "";
    els.backBtn.style.display = "none";
  }

  els.backBtn.onclick = showList;
</script>

</body>
</html>
